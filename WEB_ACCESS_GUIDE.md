# 🌐 Web界面访问指南

## ✅ 问题已修复！

您之前访问的是 **API端点**（只返回JSON数据），现在已经修复了页面路由和市场参数支持。

---

## 📍 正确的访问地址

### 选股结果页面

#### A股选股（推荐）
```
http://localhost:5000/selections?market=CN
```

#### 港股选股
```
http://localhost:5000/selections?market=HK
```

#### 美股选股
```
http://localhost:5000/selections?market=US
```

### 其他页面

#### 首页
```
http://localhost:5000/
```

#### 仪表板
```
http://localhost:5000/dashboard
```

#### K线图表
```
http://localhost:5000/kline?symbol=000001.SZ
```

#### 买卖信号
```
http://localhost:5000/trading-signals?symbol=000001.SZ
```

#### 股票对比
```
http://localhost:5000/compare
```

---

## 🔧 修复内容

### 1. API路由支持market参数

**修改文件**: `web/app.py`

**修改内容**:
- `/api/selections` 现在支持 `market` 参数
- 可以按市场过滤选股结果（HK/US/CN）

**示例**:
```
/api/selections?market=CN  # A股选股结果（JSON）
/api/selections?market=HK  # 港股选股结果（JSON）
```

### 2. 页面支持market参数

**修改文件**: `web/templates/selections.html`

**修改内容**:
- 从URL参数读取market值
- 动态更新页面标题
- 添加市场切换按钮

**功能**:
- ✅ 自动识别URL中的market参数
- ✅ 显示对应市场的选股结果
- ✅ 一键切换市场（港股/美股/A股）

### 3. 用户体验优化

**新增功能**:
- 🇭🇰 港股 / 🇺🇸 美股 / 🇨🇳 A股 切换按钮
- 页面标题显示当前市场
- 浏览器标签标题显示当前市场

---

## 🎯 使用方法

### 方法1：直接访问（推荐）

1. **启动Web服务**（如果未启动）:
   ```bash
   cd longport-quant-system
   python run.py
   ```

2. **打开浏览器，访问**:
   ```
   http://localhost:5000/selections?market=CN
   ```

3. **查看A股Top 50选股结果**

### 方法2：从首页导航

1. **访问首页**:
   ```
   http://localhost:5000/
   ```

2. **点击"选股结果"链接**

3. **使用页面上的市场切换按钮**:
   - 点击 "🇨🇳 A股" 查看A股选股
   - 点击 "🇭🇰 港股" 查看港股选股
   - 点击 "🇺🇸 美股" 查看美股选股

---

## 📊 页面功能

### 选股结果页面特性

#### 统计卡片
- **总股票数**: 显示选股数量
- **平均分数**: 所有股票的平均评分
- **最高分**: 最高评分
- **选股日期**: 选股计算日期

#### 功能按钮
- **🇭🇰 港股 / 🇺🇸 美股 / 🇨🇳 A股**: 快速切换市场
- **🔄 刷新数据**: 重新加载选股结果
- **🏠 返回首页**: 返回系统首页
- **📈 查看K线**: 跳转到K线图表页面
- **📊 股票对比**: 跳转到股票对比页面
- **📥 导出CSV**: 导出选股结果为CSV文件

#### 选股表格
- **排名**: 前三名显示奖牌图标（🥇🥈🥉）
- **代码**: 股票代码
- **名称**: 股票名称
- **总分**: 综合评分（带进度条）
- **技术指标**: 技术面评分（30分）
- **量价分析**: 成交量评分（25分）
- **趋势分析**: 趋势评分（25分）
- **形态识别**: 形态评分（20分）
- **最新价**: 最新收盘价
- **评级**: 优秀/良好/中等/一般

#### 交互功能
- **点击行**: 查看该股票的K线图
- **Ctrl+点击**: 查看该股票的买卖信号

---

## 🆚 API端点 vs 页面端点

### API端点（返回JSON）

用于程序调用，返回纯JSON数据：

```
/api/selections?market=CN
```

**返回示例**:
```json
{
  "success": true,
  "data": {
    "date": "2025-10-09",
    "selections": [
      {
        "rank": 1,
        "symbol": "600519.SH",
        "name": "贵州茅台",
        "total_score": 92.5,
        ...
      }
    ]
  }
}
```

### 页面端点（返回HTML）

用于浏览器访问，返回可视化页面：

```
/selections?market=CN
```

**显示**: 漂亮的表格、图表、按钮等可视化界面

---

## 🔍 常见问题

### Q1: 为什么我看到的是JSON数据？

**A**: 您访问的是API端点（`/api/selections`），请访问页面端点（`/selections`）。

**正确地址**:
```
http://localhost:5000/selections?market=CN  ✅
```

**错误地址**:
```
http://localhost:5000/api/selections?market=CN  ❌ (这是API端点)
```

### Q2: 如何切换查看不同市场？

**A**: 有两种方法：

**方法1**: 修改URL参数
```
?market=CN  # A股
?market=HK  # 港股
?market=US  # 美股
```

**方法2**: 点击页面上的市场切换按钮
- 🇨🇳 A股
- 🇭🇰 港股
- 🇺🇸 美股

### Q3: 页面显示"暂无选股数据"？

**A**: 可能的原因：

1. **还未运行选股脚本**:
   ```bash
   python scripts/run_stock_selection.py --market CN --top 50
   ```

2. **数据库中没有该市场的数据**:
   ```bash
   # 检查数据状态
   python scripts/check_data_status.py --market CN
   ```

3. **选股日期不匹配**:
   - 默认查询今天的选股结果
   - 如果今天没有运行选股，会显示无数据

### Q4: 如何查看单只股票的详情？

**A**: 在选股结果表格中：

- **普通点击**: 查看K线图
- **Ctrl+点击**: 查看买卖信号

或者直接访问：
```
http://localhost:5000/kline?symbol=000001.SZ
http://localhost:5000/trading-signals?symbol=000001.SZ
```

---

## 📝 完整操作流程

### 从零开始查看A股选股结果

1. **确保数据已获取**（如果还在进行中，等待完成）:
   ```bash
   # 查看终端ID 2的进度
   ```

2. **计算技术指标**:
   ```bash
   python scripts/calculate_indicators.py --batch --market CN
   ```

3. **运行选股分析**:
   ```bash
   python scripts/run_stock_selection.py --market CN --top 50
   ```

4. **启动Web服务**:
   ```bash
   python run.py
   ```

5. **打开浏览器访问**:
   ```
   http://localhost:5000/selections?market=CN
   ```

6. **查看Top 50 A股选股结果** 🎉

---

## 🎨 页面预览

### 选股结果页面包含

```
┌─────────────────────────────────────────────┐
│  🎯 智能选股结果 - A股                        │
│  基于多维度评分的量化选股系统                  │
└─────────────────────────────────────────────┘

┌──────────┬──────────┬──────────┬──────────┐
│ 总股票数  │ 平均分数  │ 最高分   │ 选股日期  │
│   50     │   75.3   │   92.5  │ 2025-10-09│
└──────────┴──────────┴──────────┴──────────┘

┌─────────────────────────────────────────────┐
│ 🇭🇰港股 🇺🇸美股 🇨🇳A股 🔄刷新 🏠首页 📥导出 │
└─────────────────────────────────────────────┘

┌────┬─────────┬────────┬──────┬────┐
│排名│  代码   │  名称  │ 总分 │评级│
├────┼─────────┼────────┼──────┼────┤
│🥇1 │600519.SH│贵州茅台│ 92.5 │优秀│
│🥈2 │000858.SZ│五粮液  │ 89.3 │优秀│
│🥉3 │300750.SZ│宁德时代│ 87.1 │优秀│
│ 4  │600036.SH│招商银行│ 85.2 │优秀│
│... │   ...   │  ...   │ ...  │... │
└────┴─────────┴────────┴──────┴────┘
```

---

## 🚀 下一步

### 完成数据获取后

1. ✅ **计算技术指标** (5-10分钟)
2. ✅ **运行选股分析** (2-3分钟)
3. ✅ **启动Web服务** (1分钟)
4. ✅ **访问可视化页面** (立即)

### 推荐访问顺序

1. **首页**: 了解系统概况
2. **A股选股**: 查看Top 50推荐
3. **K线图**: 查看感兴趣的股票
4. **买卖信号**: 获取交易建议

---

**现在您可以正确访问可视化页面了！** 🎉

**A股选股结果页面**:
```
http://localhost:5000/selections?market=CN
```

**记住**: 
- `/selections` = 可视化页面 ✅
- `/api/selections` = JSON数据 (用于程序调用)

