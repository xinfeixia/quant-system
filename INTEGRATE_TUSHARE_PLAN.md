# é›†æˆTushare/AkShareæ•°æ®æºæ–¹æ¡ˆ

## ğŸ¯ ç›®æ ‡

å°† `stock-analysis-system` ä¸­æˆç†Ÿçš„ Tushare/AkShare æ•°æ®æºé›†æˆåˆ° `longport-quant-system`ï¼Œè§£å†³é•¿æ¡¥APIçš„é¢‘ç‡é™åˆ¶é—®é¢˜ã€‚

---

## ğŸ“Š å½“å‰çŠ¶å†µ

### longport-quant-system
- âœ… **æ¸¯è‚¡**: 95åªï¼Œæ•°æ®å®Œæ•´
- âš ï¸ **ç¾è‚¡**: 7åªï¼Œæ•°æ®ä¸è¶³
- âŒ **Aè‚¡**: 10åªï¼Œå—APIé™åˆ¶ä¸¥é‡

### stock-analysis-system
- âœ… **å®Œæ•´çš„Tushareé›†æˆ**
- âœ… **å®Œæ•´çš„AkShareé›†æˆ**
- âœ… **æˆç†Ÿçš„æ•°æ®è·å–æµç¨‹**
- âœ… **å®Œå–„çš„é”™è¯¯å¤„ç†**

---

## ğŸ”„ é›†æˆæ–¹æ¡ˆ

### æ–¹æ¡ˆAï¼šå¤åˆ¶æ•°æ®æºæ¨¡å—ï¼ˆæ¨èï¼‰

**ä¼˜ç‚¹**:
- å¿«é€Ÿå®ç°
- ä»£ç æˆç†Ÿç¨³å®š
- å·²ç»è¿‡æµ‹è¯•

**æ­¥éª¤**:

1. **å¤åˆ¶æ•°æ®æºæ–‡ä»¶**
   ```bash
   # å¤åˆ¶Tushareæ•°æ®æº
   cp stock-analysis-system/data_collection/sources/tushare_source.py longport-quant-system/data_collection/
   
   # å¤åˆ¶AkShareæ•°æ®æº
   cp stock-analysis-system/data_collection/sources/akshare_source.py longport-quant-system/data_collection/
   
   # å¤åˆ¶åŸºç±»
   cp stock-analysis-system/data_collection/sources/base_source.py longport-quant-system/data_collection/
   ```

2. **å¤åˆ¶è¾…åŠ©å·¥å…·**
   ```bash
   # å¤åˆ¶é‡è¯•è£…é¥°å™¨
   cp stock-analysis-system/utils/retry.py longport-quant-system/utils/
   
   # å¤åˆ¶è¾…åŠ©å‡½æ•°
   cp stock-analysis-system/utils/helpers.py longport-quant-system/utils/
   ```

3. **æ›´æ–°é…ç½®æ–‡ä»¶**
   
   åœ¨ `config/api_config.yaml` ä¸­æ·»åŠ ï¼š
   ```yaml
   tushare:
     token: "YOUR_TUSHARE_TOKEN_HERE"
     request_interval: 0.2  # è¯·æ±‚é—´éš”ï¼ˆç§’ï¼‰
   
   akshare:
     request_interval: 1.0  # è¯·æ±‚é—´éš”ï¼ˆç§’ï¼‰
   ```

4. **åˆ›å»ºé€‚é…å™¨**
   
   åˆ›å»º `data_collection/tushare_adapter.py`ï¼Œå°†Tushareæ•°æ®æ ¼å¼è½¬æ¢ä¸ºç³»ç»Ÿæ ¼å¼

5. **åˆ›å»ºè·å–è„šæœ¬**
   
   åˆ›å»º `scripts/fetch_a_stocks_tushare.py`ï¼Œä½¿ç”¨Tushareè·å–Aè‚¡æ•°æ®

---

### æ–¹æ¡ˆBï¼šç›´æ¥ä½¿ç”¨stock-analysis-systemæ•°æ®åº“

**ä¼˜ç‚¹**:
- æ— éœ€é‡æ–°è·å–æ•°æ®
- ç«‹å³å¯ç”¨

**æ­¥éª¤**:

1. **å¯¼å‡ºæ•°æ®**
   ```bash
   # ä»stock-analysis-systemå¯¼å‡ºAè‚¡æ•°æ®
   python export_a_stock_data.py
   ```

2. **å¯¼å…¥æ•°æ®**
   ```bash
   # å¯¼å…¥åˆ°longport-quant-system
   python import_a_stock_data.py
   ```

---

## ğŸš€ æ¨èå®æ–½æ­¥éª¤

### ç¬¬1æ­¥ï¼šå‡†å¤‡Tushare Tokenï¼ˆ5åˆ†é’Ÿï¼‰

1. è®¿é—® https://tushare.pro/register
2. æ³¨å†Œè´¦å·
3. è·å–Token
4. å¡«å…¥é…ç½®æ–‡ä»¶

### ç¬¬2æ­¥ï¼šå¤åˆ¶æ•°æ®æºä»£ç ï¼ˆ10åˆ†é’Ÿï¼‰

æˆ‘å°†å¸®æ‚¨ï¼š
1. å¤åˆ¶æ‰€æœ‰å¿…è¦çš„æ–‡ä»¶
2. è°ƒæ•´å¯¼å…¥è·¯å¾„
3. é€‚é…æ•°æ®æ ¼å¼

### ç¬¬3æ­¥ï¼šåˆ›å»ºè·å–è„šæœ¬ï¼ˆ15åˆ†é’Ÿï¼‰

åˆ›å»ºä¸“é—¨çš„Aè‚¡æ•°æ®è·å–è„šæœ¬ï¼š
- ä½¿ç”¨Tushareè·å–å†å²æ•°æ®
- è‡ªåŠ¨è½¬æ¢ä¸ºç³»ç»Ÿæ ¼å¼
- ä¿å­˜åˆ°æ•°æ®åº“

### ç¬¬4æ­¥ï¼šè·å–Aè‚¡æ•°æ®ï¼ˆ1-2å°æ—¶ï¼‰

è¿è¡Œè„šæœ¬è·å–152åªAè‚¡çš„å†å²æ•°æ®ï¼š
- æ— é¢‘ç‡é™åˆ¶é—®é¢˜
- æ•°æ®è´¨é‡é«˜
- è‡ªåŠ¨é‡è¯•æœºåˆ¶

### ç¬¬5æ­¥ï¼šè®¡ç®—æŒ‡æ ‡å’Œé€‰è‚¡ï¼ˆ10åˆ†é’Ÿï¼‰

```bash
# è®¡ç®—æŠ€æœ¯æŒ‡æ ‡
python scripts/calculate_indicators.py --batch --market CN

# è¿è¡Œé€‰è‚¡
python scripts/run_stock_selection.py --market CN --top 50
```

---

## ğŸ“ éœ€è¦åˆ›å»ºçš„æ–‡ä»¶

### 1. data_collection/tushare_source.py
- Tushareæ•°æ®æºå®ç°
- ä»stock-analysis-systemå¤åˆ¶å¹¶é€‚é…

### 2. data_collection/akshare_source.py
- AkShareæ•°æ®æºå®ç°
- ä»stock-analysis-systemå¤åˆ¶å¹¶é€‚é…

### 3. data_collection/base_source.py
- æ•°æ®æºåŸºç±»
- å®šä¹‰ç»Ÿä¸€æ¥å£

### 4. utils/retry.py
- é‡è¯•è£…é¥°å™¨
- å¤„ç†ç½‘ç»œé”™è¯¯

### 5. utils/helpers.py
- è¾…åŠ©å‡½æ•°
- è‚¡ç¥¨ä»£ç è½¬æ¢ç­‰

### 6. scripts/fetch_a_stocks_tushare.py
- Aè‚¡æ•°æ®è·å–è„šæœ¬
- ä½¿ç”¨Tushare API

### 7. scripts/fetch_a_stocks_akshare.py
- Aè‚¡æ•°æ®è·å–è„šæœ¬ï¼ˆå¤‡é€‰ï¼‰
- ä½¿ç”¨AkShare API

---

## ğŸ”§ ä»£ç é€‚é…è¦ç‚¹

### 1. æ•°æ®æ ¼å¼è½¬æ¢

**Tushareæ ¼å¼** â†’ **ç³»ç»Ÿæ ¼å¼**

```python
# Tushareè¿”å›
{
    'trade_date': '20251009',
    'open': 10.5,
    'close': 10.8,
    'high': 11.0,
    'low': 10.3,
    'vol': 1000000,
    'amount': 10800000
}

# è½¬æ¢ä¸ºç³»ç»Ÿæ ¼å¼
{
    'symbol': '000001.SZ',
    'trade_date': datetime(2025, 10, 9),
    'open': 10.5,
    'close': 10.8,
    'high': 11.0,
    'low': 10.3,
    'volume': 1000000,
    'turnover': 10800000
}
```

### 2. è‚¡ç¥¨ä»£ç è½¬æ¢

```python
# ç³»ç»Ÿæ ¼å¼: 000001.SZ
# Tushareæ ¼å¼: 000001.SZ (ç›¸åŒ)
# éœ€è¦å¤„ç†çš„æƒ…å†µ:
# - å»é™¤å¸‚åœºå‰ç¼€: sh000001 â†’ 000001
# - æ·»åŠ å¸‚åœºåç¼€: 000001 â†’ 000001.SZ
```

### 3. æ—¥æœŸæ ¼å¼è½¬æ¢

```python
# Tushare: '20251009' (YYYYMMDD)
# ç³»ç»Ÿ: datetime(2025, 10, 9) æˆ– '2025-10-09'
```

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### è·å–å•åªè‚¡ç¥¨æ•°æ®

```python
from data_collection.tushare_source import TushareDataSource

# åˆå§‹åŒ–
config = {'token': 'your_token_here'}
source = TushareDataSource(config)

# è·å–æ—¥çº¿æ•°æ®
df = source.get_daily_data(
    stock_code='000001.SZ',
    start_date='2024-10-09',
    end_date='2025-10-09'
)

print(f"è·å–åˆ° {len(df)} æ¡æ•°æ®")
```

### æ‰¹é‡è·å–Aè‚¡æ•°æ®

```bash
# ä½¿ç”¨Tushareè·å–æ‰€æœ‰152åªAè‚¡
python scripts/fetch_a_stocks_tushare.py --days 365

# é¢„è®¡æ—¶é—´: 1-2å°æ—¶
# æ— é¢‘ç‡é™åˆ¶é—®é¢˜
```

---

## ğŸ“Š é¢„æœŸæ•ˆæœ

### æ•°æ®è·å–é€Ÿåº¦

| æ•°æ®æº | å•åªè‚¡ç¥¨ | 152åªAè‚¡ | é™åˆ¶ |
|--------|---------|---------|------|
| **é•¿æ¡¥API** | 30ç§’ | 76åˆ†é’Ÿ | âŒ ä¸¥æ ¼é™åˆ¶ |
| **Tushare** | 0.5ç§’ | 1.3åˆ†é’Ÿ | âœ… å®½æ¾é™åˆ¶ |
| **AkShare** | 1ç§’ | 2.5åˆ†é’Ÿ | âœ… æ— é™åˆ¶ |

### æ•°æ®è´¨é‡

| é¡¹ç›® | é•¿æ¡¥API | Tushare | AkShare |
|------|---------|---------|---------|
| **å‡†ç¡®æ€§** | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ |
| **å®Œæ•´æ€§** | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ |
| **ç¨³å®šæ€§** | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ |
| **å®æ—¶æ€§** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ |

---

## ğŸ¯ æœ€ç»ˆæ¶æ„

### å¤šæ•°æ®æºç­–ç•¥

```
longport-quant-system
â”œâ”€â”€ æ¸¯è‚¡æ•°æ® â†’ é•¿æ¡¥API âœ…
â”œâ”€â”€ ç¾è‚¡æ•°æ® â†’ é•¿æ¡¥API âš ï¸
â””â”€â”€ Aè‚¡æ•°æ® â†’ Tushare/AkShare âœ…
```

### ä¼˜åŠ¿

1. âœ… **å……åˆ†åˆ©ç”¨å„æ•°æ®æºä¼˜åŠ¿**
   - é•¿æ¡¥API: æ¸¯è‚¡ã€ç¾è‚¡å®æ—¶æ•°æ®
   - Tushare: Aè‚¡å†å²æ•°æ®
   - AkShare: å¤‡ç”¨æ•°æ®æº

2. âœ… **é¿å…å•ç‚¹æ•…éšœ**
   - ä¸€ä¸ªæ•°æ®æºå¤±è´¥ï¼Œå¯åˆ‡æ¢åˆ°å¦ä¸€ä¸ª
   - æé«˜ç³»ç»Ÿå¯é æ€§

3. âœ… **é™ä½æˆæœ¬**
   - Tushareå…è´¹ç‰ˆè¶³å¤Ÿä½¿ç”¨
   - AkShareå®Œå…¨å…è´¹
   - é•¿æ¡¥APIç”¨äºæ¸¯è‚¡ç¾è‚¡

---

## ğŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¯åš

1. **æ³¨å†ŒTushareè´¦å·**
   - è®¿é—® https://tushare.pro/register
   - è·å–Token

2. **å‡†å¤‡å¥½Token**
   - å¤åˆ¶Token
   - å‡†å¤‡å¡«å…¥é…ç½®

### ç­‰æˆ‘å¸®æ‚¨å®Œæˆ

1. **å¤åˆ¶æ•°æ®æºä»£ç **
   - ä»stock-analysis-systemå¤åˆ¶
   - é€‚é…åˆ°longport-quant-system

2. **åˆ›å»ºè·å–è„šæœ¬**
   - ç¼–å†™Aè‚¡æ•°æ®è·å–è„šæœ¬
   - æµ‹è¯•æ•°æ®è·å–

3. **è·å–Aè‚¡æ•°æ®**
   - è¿è¡Œè„šæœ¬
   - è·å–152åªAè‚¡å†å²æ•°æ®

4. **å®Œæˆåˆ†æ**
   - è®¡ç®—æŠ€æœ¯æŒ‡æ ‡
   - è¿è¡Œé€‰è‚¡
   - æŸ¥çœ‹ç»“æœ

---

## ğŸ‰ é¢„æœŸç»“æœ

å®Œæˆåï¼Œæ‚¨å°†æ‹¥æœ‰ï¼š

- âœ… **340åªè‚¡ç¥¨** çš„å®Œæ•´æ•°æ®
  - 136åªæ¸¯è‚¡ âœ…
  - 52åªç¾è‚¡ âš ï¸
  - 152åªAè‚¡ âœ…

- âœ… **å¤šæ•°æ®æºæ”¯æŒ**
  - é•¿æ¡¥APIï¼ˆæ¸¯è‚¡ã€ç¾è‚¡ï¼‰
  - Tushareï¼ˆAè‚¡ï¼‰
  - AkShareï¼ˆå¤‡ç”¨ï¼‰

- âœ… **å®Œæ•´çš„åˆ†æç³»ç»Ÿ**
  - æŠ€æœ¯æŒ‡æ ‡è®¡ç®—
  - æ™ºèƒ½é€‰è‚¡
  - ä¹°å–ä¿¡å·
  - å¯è§†åŒ–å±•ç¤º

---

**å‡†å¤‡å¥½å¼€å§‹äº†å—ï¼Ÿè¯·å‘Šè¯‰æˆ‘æ‚¨çš„Tushare Tokenï¼Œæˆ‘å°†ç«‹å³å¼€å§‹é›†æˆï¼** ğŸš€

